{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\stalk\\\\jm-blog-platform\\\\src\\\\components\\\\articles-list\\\\index.js\";\nimport React, { useEffect, useState } from 'react';\nimport { Pagination } from 'antd';\nimport { connect } from 'react-redux';\nimport * as actions from '../../redux/actions';\nimport { renderLoader } from '../../helper';\nimport propTypes from 'prop-types';\nimport { ArticlesWrapper, PaginationWrapper, ArticlesItemsWrapper } from '../../styled-components';\nimport Article from './article';\n\nconst mapStateToProps = state => {\n  const {\n    articles,\n    getArticlesState,\n    createArticleState,\n    editArticleState\n  } = state;\n  const props = {\n    articles,\n    isArticlesReady: getArticlesState === 'finished',\n    isRequestProcessed: getArticlesState === 'processed',\n    isNewArticleCreated: createArticleState === 'finished',\n    isArticleEdited: editArticleState === 'finished'\n  };\n  return props;\n};\n\nconst actionCreator = {\n  getArticles: actions.getArticles,\n  refreshArticles: actions.refreshArticles\n};\n\nconst ArticlesList = props => {\n  const {\n    getArticles,\n    articles,\n    isArticlesReady,\n    isRequestProcessed,\n    isNewArticleCreated,\n    refreshArticles,\n    isArticleEdited\n  } = props;\n  const [currentPageNumber, setCurrentPageNumber] = useState(1);\n  const [currentPageSize, setPageSize] = useState(5); // делаем фейковые лайки для визуального обновления без лишних запросов на сервер\n\n  const [fakeLikes, setFakeLikes] = useState([]);\n\n  const getArticlesRequest = async () => {\n    await getArticles();\n  };\n\n  const renderArticles = (pageNumber, pageSize) => {\n    const from = pageNumber * pageSize - pageSize;\n    const to = pageNumber * pageSize;\n    const currentArticlesArray = Array.from(articles).slice(from, to);\n    const currentFakeLikes = Array.from(fakeLikes).slice(from, to);\n    return /*#__PURE__*/React.createElement(Article, {\n      articles: currentArticlesArray,\n      fakeLikes: currentFakeLikes,\n      setFakeLikes: setFakeLikes,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 7\n      }\n    });\n  };\n\n  const handleOnChangePagination = (value, pageSize) => {\n    setCurrentPageNumber(value);\n    setPageSize(pageSize);\n  };\n\n  const renderPagination = total => /*#__PURE__*/React.createElement(Pagination, {\n    size: \"small\",\n    total: total,\n    pageSize: 5,\n    showSizeChanger: false,\n    onChange: handleOnChangePagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  });\n\n  useEffect(() => {\n    // получаем посты пока они есть и убираем дублирование запроса если создан новый пост\n    if (!isArticlesReady && !isNewArticleCreated && !isArticleEdited) {\n      getArticlesRequest();\n    } // обновляем посты после создания поста или редактирования\n\n\n    if (isNewArticleCreated || isArticleEdited) refreshArticles();\n  }, [isArticlesReady, isNewArticleCreated, isArticleEdited]);\n  useEffect(() => {\n    // после каждой пачки постов делаем для них фейковые лайки\n    setFakeLikes(() => articles.map(el => ({\n      id: el.id,\n      isLiked: el.favorited,\n      likesCount: el.favoritesCount,\n      slug: el.slug\n    })));\n  }, [articles]);\n  return /*#__PURE__*/React.createElement(ArticlesWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ArticlesItemsWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, isRequestProcessed || isArticlesReady ? renderArticles(currentPageNumber, currentPageSize) : renderLoader()), /*#__PURE__*/React.createElement(PaginationWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }, renderPagination(articles.length)));\n};\n\nArticlesList.propTypes = {\n  getArticles: propTypes.func,\n  articles: propTypes.arrayOf(propTypes.object),\n  isArticlesReady: propTypes.bool,\n  isRequestProcessed: propTypes.bool,\n  isNewArticleCreated: propTypes.bool,\n  refreshArticles: propTypes.func,\n  isArticleEdited: propTypes.bool\n};\nArticlesList.defaultProps = {\n  getArticles: null,\n  articles: [],\n  isArticlesReady: false,\n  isRequestProcessed: false,\n  isNewArticleCreated: false,\n  refreshArticles: null,\n  isArticleEdited: false\n};\nexport default connect(mapStateToProps, actionCreator)(ArticlesList);","map":{"version":3,"sources":["C:/Users/stalk/jm-blog-platform/src/components/articles-list/index.js"],"names":["React","useEffect","useState","Pagination","connect","actions","renderLoader","propTypes","ArticlesWrapper","PaginationWrapper","ArticlesItemsWrapper","Article","mapStateToProps","state","articles","getArticlesState","createArticleState","editArticleState","props","isArticlesReady","isRequestProcessed","isNewArticleCreated","isArticleEdited","actionCreator","getArticles","refreshArticles","ArticlesList","currentPageNumber","setCurrentPageNumber","currentPageSize","setPageSize","fakeLikes","setFakeLikes","getArticlesRequest","renderArticles","pageNumber","pageSize","from","to","currentArticlesArray","Array","slice","currentFakeLikes","handleOnChangePagination","value","renderPagination","total","map","el","id","isLiked","favorited","likesCount","favoritesCount","slug","length","func","arrayOf","object","bool","defaultProps"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Pagination } from 'antd';\nimport { connect } from 'react-redux';\nimport * as actions from '../../redux/actions';\nimport { renderLoader } from '../../helper';\nimport propTypes from 'prop-types';\nimport {\n  ArticlesWrapper,\n  PaginationWrapper,\n  ArticlesItemsWrapper,\n} from '../../styled-components';\nimport Article from './article';\n\nconst mapStateToProps = (state) => {\n  const { articles, getArticlesState, createArticleState, editArticleState } = state;\n\n  const props = {\n    articles,\n    isArticlesReady: getArticlesState === 'finished',\n    isRequestProcessed: getArticlesState === 'processed',\n    isNewArticleCreated: createArticleState === 'finished',\n    isArticleEdited: editArticleState === 'finished',\n  };\n\n  return props;\n};\n\nconst actionCreator = {\n  getArticles: actions.getArticles,\n  refreshArticles: actions.refreshArticles,\n};\n\nconst ArticlesList = (props) => {\n  const {\n    getArticles, articles, isArticlesReady, isRequestProcessed,\n    isNewArticleCreated, refreshArticles, isArticleEdited\n  } = props;\n\n  const [currentPageNumber, setCurrentPageNumber] = useState(1);\n  const [currentPageSize, setPageSize] = useState(5);\n\n  // делаем фейковые лайки для визуального обновления без лишних запросов на сервер\n  const [fakeLikes, setFakeLikes] = useState([]);\n\n  const getArticlesRequest = async () => {\n    await getArticles();\n  };\n\n  const renderArticles = (pageNumber, pageSize) => {\n    const from = pageNumber * pageSize - pageSize;\n    const to = pageNumber * pageSize;\n    const currentArticlesArray = Array.from(articles).slice(from, to);\n    const currentFakeLikes = Array.from(fakeLikes).slice(from, to);\n\n    return (\n      <Article\n        articles={currentArticlesArray}\n        fakeLikes={currentFakeLikes}\n        setFakeLikes={setFakeLikes}\n      />\n    );\n  };\n\n  const handleOnChangePagination = (value, pageSize) => {\n    setCurrentPageNumber(value);\n    setPageSize(pageSize);\n  };\n\n  const renderPagination = (total) => (\n    <Pagination\n      size=\"small\"\n      total={total}\n      pageSize={5}\n      showSizeChanger={false}\n      onChange={handleOnChangePagination}\n    />\n  );\n\n  useEffect(() => {\n    // получаем посты пока они есть и убираем дублирование запроса если создан новый пост\n    if (!isArticlesReady && !isNewArticleCreated && !isArticleEdited) {\n      getArticlesRequest();\n    }\n\n    // обновляем посты после создания поста или редактирования\n    if (isNewArticleCreated || isArticleEdited) refreshArticles();\n  }, [isArticlesReady, isNewArticleCreated, isArticleEdited]);\n\n  useEffect(() => {\n    // после каждой пачки постов делаем для них фейковые лайки\n    setFakeLikes(() => articles.map((el) => ({\n      id: el.id, isLiked: el.favorited, likesCount: el.favoritesCount, slug: el.slug,\n    })));\n  }, [articles]);\n\n  return (\n    <ArticlesWrapper>\n      <ArticlesItemsWrapper>\n        {(isRequestProcessed || isArticlesReady)\n          ? renderArticles(currentPageNumber, currentPageSize)\n          : renderLoader()}\n      </ArticlesItemsWrapper>\n\n      <PaginationWrapper>\n        {renderPagination(articles.length)}\n      </PaginationWrapper>\n    </ArticlesWrapper>\n  );\n};\n\nArticlesList.propTypes = {\n  getArticles: propTypes.func,\n  articles: propTypes.arrayOf(propTypes.object),\n  isArticlesReady: propTypes.bool,\n  isRequestProcessed: propTypes.bool,\n  isNewArticleCreated: propTypes.bool,\n  refreshArticles: propTypes.func,\n  isArticleEdited: propTypes.bool,\n};\n\nArticlesList.defaultProps = {\n  getArticles: null,\n  articles: [],\n  isArticlesReady: false,\n  isRequestProcessed: false,\n  isNewArticleCreated: false,\n  refreshArticles: null,\n  isArticleEdited: false,\n};\n\nexport default connect(mapStateToProps, actionCreator)(ArticlesList);\n"]},"metadata":{},"sourceType":"module"}